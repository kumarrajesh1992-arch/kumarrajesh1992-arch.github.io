{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Technical Efficiency and Income-Adjusted HDI",
    "subtitle": "Faceted comparison: health vs education technical efficiency across Indian states",
    "anchor": "middle",
    "fontSize": 14,
    "subtitleFontSize": 11
  },
  "data": {
    "url": "https://raw.githubusercontent.com/kumarrajesh1992-arch/kumarrajesh1992-arch.github.io/refs/heads/main/project/data/PC6_Health_Education_Efficiency.csv"
  },
  "transform": [
    {
      "calculate": "datum.Efficiency_Type == 'Health_TE_z' ? 'Health technical efficiency (z)' : 'Education technical efficiency (z)'",
      "as": "FacetLabel"
    },
    {
      "calculate": "datum.Efficiency_Type == 'Health_TE_z' ? 'β = 0.7620 | Model R² = 0.229' : 'β = -0.5092 | Model R² = 0.229'",
      "as": "ModelStats"
    }
  ],
  "columns": 2,
  "facet": {
    "field": "FacetLabel",
    "type": "nominal",
    "title": null,
    "header": { "labelFontSize": 13, "labelFontWeight": "bold" }
  },
  "spec": {
    "width": 420,
    "height": 380,
    "layer": [
      {
        "mark": { "type": "point", "filled": true, "size": 140, "opacity": 0.85 },
        "encoding": {
          "x": {
            "field": "Efficiency_z",
            "type": "quantitative",
            "title": "Technical Efficiency (z-score)"
          },
          "y": {
            "field": "HDI_residual_z",
            "type": "quantitative",
            "title": "HDI Residual (z-score)"
          },
          "color": {
            "field": "Efficiency_Type",
            "type": "nominal",
            "legend": null
          },
          "tooltip": [
            { "field": "State", "type": "nominal", "title": "State" },
            { "field": "FacetLabel", "type": "nominal", "title": "Measure" },
            {
              "field": "Efficiency_z",
              "type": "quantitative",
              "title": "Efficiency (z)",
              "format": ".2f"
            },
            {
              "field": "HDI_residual_z",
              "type": "quantitative",
              "title": "HDI residual (z)",
              "format": ".2f"
            }
          ]
        }
      },
      {
        "transform": [
          {
            "filter": "datum.Efficiency_Type == 'Health_TE_z' && (datum.State == 'Kerala' || datum.State == 'Manipur' || datum.State == 'Nagaland' || datum.State == 'Sikkim' || datum.State == 'Gujarat' || datum.State == 'Andhra Pradesh')"
          }
        ],
        "mark": {
          "type": "text",
          "align": "center",
          "baseline": "top",
          "dy": 8,
          "fontSize": 9,
          "fontWeight": "normal"
        },
        "encoding": {
          "x": { "field": "Efficiency_z", "type": "quantitative" },
          "y": { "field": "HDI_residual_z", "type": "quantitative" },
          "text": { "field": "State", "type": "nominal" }
        }
      },
      {
        "transform": [
          {
            "regression": "HDI_residual_z",
            "on": "Efficiency_z",
            "groupby": ["Efficiency_Type"]
          }
        ],
        "mark": { "type": "line", "strokeWidth": 2, "opacity": 0.9 },
        "encoding": {
          "x": { "field": "Efficiency_z", "type": "quantitative" },
          "y": { "field": "HDI_residual_z", "type": "quantitative" },
          "color": { "field": "Efficiency_Type", "type": "nominal", "legend": null }
        }
      },
      {
        "mark": {
          "type": "text",
          "align": "left",
          "baseline": "top",
          "dx": 6,
          "dy": 6,
          "fontSize": 10,
          "fontWeight": "normal",
          "color": "#6e6c6c"
        },
        "encoding": {
          "x": { "value": 0 },
          "y": { "value": 0 },
          "text": { "field": "ModelStats" }
        }
      }
    ]
  },
  "resolve": { "scale": { "x": "shared", "y": "shared" } },
  "config": { "axis": { "labelFontSize": 12, "titleFontSize": 13 } }
}
